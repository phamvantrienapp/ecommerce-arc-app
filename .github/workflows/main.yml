name: Test, Build and Release apk # Flutter for Android

on: push
#   push:
#     branches: [ master ]
#   pull_request:
#     branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2

      - name: Set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 1.8

      - name: Setup Android SDK
        uses: android-actions/setup-android@v2

      - name: Setup Flutter SDK
        uses: flutter-actions/setup-flutter@v2
        with:
          channel: stable
          version: 3.10.1

      - name: Install dependencies
        run: flutter pub get

      - name: Analyze project source
        run: dart analyze

      - name: Run tests
        run: flutter test
        
#       - name: Create a Release APK
#         uses: ncipollo/release-action@v1
#         with:
#           artifacts: "build/app/outputs/apk/debug/*.apk"
#           token: ${{ secrets.ECOMMERCEARCTOKEN }}
   
   
# on: push
# name: Test, Build and Release apk
# jobs:
#   build:
#     name: Build APK
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v1
#       - uses: actions/setup-java@v3
#         with:
#           distribution: 'zulu'
#           java-version: "12.x"
#           cache: 'gradle'
#       - uses: subosito/flutter-action@v2
#         with:
#           flutter-version: "3.10.1"
#           channel: 'stable'
#           cache: true
#       - run: flutter pub get
#       - run: flutter test
#       - run: flutter build apk --debug --split-per-abi
#       - name: Create a Release APK
#         uses: ncipollo/release-action@v1
#         with:
#           artifacts: "build/app/outputs/apk/debug/*.apk"
#           token: ${{ secrets.ECOMMERCEARCTOKEN }}
